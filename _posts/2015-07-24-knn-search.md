---
layout:     post
title:      "用kd树的最近邻搜索"
data: 2015-07-24 15:17:36
permalink:  knn-search.html
categories: 机器学习
tags: knn
excerpt: 使用kd树来进行knn的最近邻搜索
mathjax: true
---

* content
{:toc}

## 算法
$\qquad$ 输入：已构造的 $kd$ 树；目标点 $x$ ;

$\qquad$ 输出：$x$ 的最近邻。

$\qquad$ (1) 在 $kd$ 树中找出包含目标点 $x$ 的叶节点：从根节点出发，递归地向下访问 $kd$ 树。若目标点 $x$ 当前维的坐标小于切分点的坐标，则移动到左子节点，否则移动到右子节点。直到子节点为叶节点为止。

$\qquad$ (2) 以此叶节点为“当前最近点”。

$\qquad$ (3) 递归地向上回退，在每个节点进行以下操作：

$\qquad\quad$ (a) 如果该节点保存的实例点比当前最近点距离目标点更近，则以该实例点为“当前最近点”。

$\qquad\quad$ (b) 当前最近点一定存在于该节点一个子节点对应的区域。检查该子节点的父节点的另一子节点对应的区域是否有更近的点。具体地，检查另一子节点对应的区域是否与以目标点为球心、以目标点与“当前最近点”间的距离为半径的超球体相交。

$\qquad\quad$如果相交，可能在另一个子节点对应的区域内存在距目标点更近的点，移动到另一子节点。接着，递归地进行最近邻搜索；

$\qquad\quad$如果不相交，向上回退。

$\qquad$ (4) 当回退到根节点时，搜索结束。最后的“当前最近点”即为 $x$ 的最近邻点。
